<%- include('../partials/header.ejs')%>
    <div class = "content">
        <h2><%=user.userName%> trade history</h2>

        <div class="tab">
            <button class="tablinks" onclick="openTab(event, 'sentOffers')" id="defaultOpen">Sent Offers</button>
            <button class="tablinks" onclick="openTab(event, 'receivedOffers')">Received Offers</button>
        </div>

        <div id="sentOffers" class="tabcontent">
            <%if(sentOffers.length) {%>
                <div class="profile-component">
                    <h3>Sent offers: </h3>
                    <div class="post">
                        <%sentOffers.forEach(offer => {%>
                                <div class="post-row">
                                <div class="offer-component">
                                    <h4>You offered </h4>
                                    <div class="offer-links">
                                        <div class="post-img"><a href='/trades/<%= offer.optionItem._id%>'><img src="<%=offer.optionItem.img%>" alt="post-img"></a></div>
                                        <div class="post-info">
                                            <table>
                                                <tr>
                                                    <td class="post-align-top"><label for="title">Title: </label></td>
                                                    <td class="post-align-right"><p><a href='/trades/<%= offer.optionItem.id%>'><%=offer.optionItem.title%></a></p></td>
                                                </tr>
                                                <tr>
                                                    <td class="post-align-top"><label for="artist">Artist: </label></td>
                                                    <td class="post-align-right"><p><%=offer.optionItem.artist%></p></td>
                                                </tr>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                <div class="offer-component">
                                    <h4>In exchange for </h4>
                                    <div class="offer-links">
                                        <div class="post-img"><a href='/trades/<%= offer.interestItem._id%>'><img src="<%=offer.interestItem.img%>" alt="post-img"></a></div>
                                        <div class="post-info">
                                            <table>
                                                <tr>
                                                    <td class="post-align-top"><label for="title">Title: </label></td>
                                                    <td class="post-align-right"><p><a href='/trades/<%= offer.interestItem.id%>'><%=offer.interestItem.title%></a></p></td>
                                                </tr>
                                                <tr>
                                                    <td class="post-align-top"><label for="artist">Artist: </label></td>
                                                    <td class="post-align-right"><p><%=offer.interestItem.artist%></p></td>
                                                </tr>
                                            </table> 
                                        </div>
                                    </div>
                                </div>
                                <div class="offer-component">
                                    <h4>Offer detalils</h4>
                                    <div class="offer-overview">
                                    <table>
                                        <tr>
                                            <td class="post-align-top"><label for="status">Status: </label></td>
                                            <td class="offer-output"><p><%=offer.status%></p></td>
                                        </tr>
                                        <tr>
                                            <td class="post-align-top"><label for="offerDate">Offer start date: </label></td>
                                            <td class="post-align-right"><p><%=offer.createdAt.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric'})%></p></td>
                                        </tr>
                                        <tr>
                                            <td class="post-align-top"><label for="offerDate">Offer start time: </label></td>
                                            <td class="offer-output"><p><%=offer.createdAt.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', timeZoneName: 'short'})%></p></td>
                                        </tr>
                                        <tr>
                                            <td class="offer-label"><label for="offerDate">Offer end date: </label></td>
                                            <td class="post-align-right"><p><%=offer.updatedAt.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric'})%></p></td>
                                        </tr>
                                        <tr>
                                            <td class="offer-label"><label for="offerDate">Offer end time: </label></td>
                                            <td class="offer-output"><p><%=offer.updatedAt.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', timeZoneName: 'short'})%></p></td>
                                        </tr>
                                    </table> 
                                    </div>
                                </div>
                            </div>
                        <%})%>
                    </div>
                </div>
            <%}%>
        </div>

        <div id="receivedOffers" class="tabcontent">
            <%if(receivedOffers.length) {%>
                <div class="profile-component">
                    <h3>Recevied offers: </h3>
                    <div class="post">
                        <%receivedOffers.forEach(offer => {%>
                            <div class="post-row">
                                <div class="offer-component">
                                    <h4>You receive</h4>
                                    <div class="offer-links">
                                        <div class="post-img"><a href='/trades/<%= offer.optionItem._id%>'><img src="<%=offer.optionItem.img%>" alt="post-img"></a></div>
                                        <div class="post-info">
                                            <table>
                                                <tr>
                                                    <td class="post-align-top"><label for="title">Title: </label></td>
                                                    <td class="post-align-right"><p><a href='/trades/<%= offer.optionItem.id%>'><%=offer.optionItem.title%></a></p></td>
                                                </tr>
                                                <tr>
                                                    <td class="post-align-top"><label for="artist">Artist: </label></td>
                                                    <td class="post-align-right"><p><%=offer.optionItem.artist%></p></td>
                                                </tr>
                                            </table> 
                                        </div>
                                    </div>
                                </div>
                                <div class="offer-component">
                                    <h4>In exchange for</h4>
                                    <div class="offer-links">
                                        <div class="post-img"><a href='/trades/<%= offer.interestItem._id%>'><img src="<%=offer.interestItem.img%>" alt="post-img"></a></div>
                                        <div class="post-info">
                                            <table>
                                                <tr>
                                                    <td class="post-align-top"><label for="title">Title: </label></td>
                                                    <td class="post-align-right"><p><a href='/trades/<%= offer.interestItem.id%>'><%=offer.interestItem.title%></a></p></td>
                                                </tr>
                                                <tr>
                                                    <td class="post-align-top"><label for="artist">Artist: </label></td>
                                                    <td class="post-align-right"><p><%=offer.interestItem.artist%></p></td>
                                                </tr>
                                            </table> 
                                        </div>
                                    </div>
                                </div>
                                <div class="offer-component">
                                    <h4>Offer detalils</h4>
                                    <div class="offer-overview">
                                        <table>
                                            <tr>
                                                <td class="post-align-top"><label for="status">Status: </label></td>
                                                <td class="offer-output"><p><%=offer.status%></p></td>
                                            </tr>
                                            <tr>
                                                <td class="post-align-top"><label for="offerDate">Offer start date: </label></td>
                                                <td class="post-align-right"><p><%=offer.createdAt.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric'})%></p></td>
                                            </tr>
                                            <tr>
                                                <td class="post-align-top"><label for="offerDate">Offer start time: </label></td>
                                                <td class="offer-output"><p><%=offer.createdAt.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', timeZoneName: 'short'})%></p></td>
                                            </tr>
                                            <tr>
                                                <td class="offer-label"><label for="offerDate">Offer end date: </label></td>
                                                <td class="post-align-right"><p><%=offer.updatedAt.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric'})%></p></td>
                                            </tr>
                                            <tr>
                                                <td class="offer-label"><label for="offerDate">Offer end time: </label></td>
                                                <td class="offer-output"><p><%=offer.updatedAt.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', timeZoneName: 'short'})%></p></td>
                                            </tr>
                                        </table> 
                                    </div>
                                </div>
                            </div>
                        <%})%>
                    </div>
                </div>
            <%}%>
        </div>

        <script>
            function openTab(evt, tabName) {
              var i, tabcontent, tablinks;
              tabcontent = document.getElementsByClassName("tabcontent");
              for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
              }
              tablinks = document.getElementsByClassName("tablinks");
              for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
              }
              document.getElementById(tabName).style.display = "block";
              evt.currentTarget.className += " active";
            }
            document.getElementById("defaultOpen").click();
        </script>
    </div>
<%- include('../partials/footer.ejs')%>